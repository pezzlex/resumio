{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { invariant } from './invariant';\nimport { toObject, getOption } from './polyfill-utils';\nexport function createResolveLocale(getDefaultLocale) {\n  var lookupMatcher = createLookupMatcher(getDefaultLocale);\n  var bestFitMatcher = createBestFitMatcher(getDefaultLocale);\n  /**\n   * https://tc39.es/ecma402/#sec-resolvelocale\n   */\n\n  return function resolveLocale(availableLocales, requestedLocales, options, relevantExtensionKeys, localeData) {\n    var matcher = options.localeMatcher;\n    var r;\n\n    if (matcher === 'lookup') {\n      r = lookupMatcher(availableLocales, requestedLocales);\n    } else {\n      r = bestFitMatcher(availableLocales, requestedLocales);\n    }\n\n    var foundLocale = r.locale;\n    var result = {\n      locale: '',\n      dataLocale: foundLocale\n    };\n    var supportedExtension = '-u';\n\n    for (var _i = 0, relevantExtensionKeys_1 = relevantExtensionKeys; _i < relevantExtensionKeys_1.length; _i++) {\n      var key = relevantExtensionKeys_1[_i];\n      var foundLocaleData = localeData[foundLocale];\n      invariant(typeof foundLocaleData === 'object' && foundLocaleData !== null, \"locale data \" + key + \" must be an object\");\n      var keyLocaleData = foundLocaleData[key];\n      invariant(Array.isArray(keyLocaleData), \"keyLocaleData for \" + key + \" must be an array\");\n      var value = keyLocaleData[0];\n      invariant(typeof value === 'string' || value === null, \"value must be string or null but got \" + typeof value + \" in key \" + key);\n      var supportedExtensionAddition = '';\n\n      if (r.extension) {\n        var requestedValue = unicodeExtensionValue(r.extension, key);\n\n        if (requestedValue !== undefined) {\n          if (requestedValue !== '') {\n            if (~keyLocaleData.indexOf(requestedValue)) {\n              value = requestedValue;\n              supportedExtensionAddition = \"-\" + key + \"-\" + value;\n            }\n          } else if (~requestedValue.indexOf('true')) {\n            value = 'true';\n            supportedExtensionAddition = \"-\" + key;\n          }\n        }\n      }\n\n      if (key in options) {\n        var optionsValue = options[key];\n        invariant(typeof optionsValue === 'string' || typeof optionsValue === 'undefined' || optionsValue === null, 'optionsValue must be String, Undefined or Null');\n\n        if (~keyLocaleData.indexOf(optionsValue)) {\n          if (optionsValue !== value) {\n            value = optionsValue;\n            supportedExtensionAddition = '';\n          }\n        }\n      }\n\n      result[key] = value;\n      supportedExtension += supportedExtensionAddition;\n    }\n\n    if (supportedExtension.length > 2) {\n      var privateIndex = foundLocale.indexOf('-x-');\n\n      if (privateIndex === -1) {\n        foundLocale = foundLocale + supportedExtension;\n      } else {\n        var preExtension = foundLocale.slice(0, privateIndex);\n        var postExtension = foundLocale.slice(privateIndex, foundLocale.length);\n        foundLocale = preExtension + supportedExtension + postExtension;\n      }\n\n      foundLocale = Intl.getCanonicalLocales(foundLocale)[0];\n    }\n\n    result.locale = foundLocale;\n    return result;\n  };\n}\n/**\n * https://tc39.es/ecma402/#sec-unicodeextensionvalue\n * @param extension\n * @param key\n */\n\nfunction unicodeExtensionValue(extension, key) {\n  invariant(key.length === 2, 'key must have 2 elements');\n  var size = extension.length;\n  var searchValue = \"-\" + key + \"-\";\n  var pos = extension.indexOf(searchValue);\n\n  if (pos !== -1) {\n    var start = pos + 4;\n    var end = start;\n    var k = start;\n    var done = false;\n\n    while (!done) {\n      var e = extension.indexOf('-', k);\n      var len = void 0;\n\n      if (e === -1) {\n        len = size - k;\n      } else {\n        len = e - k;\n      }\n\n      if (len === 2) {\n        done = true;\n      } else if (e === -1) {\n        end = size;\n        done = true;\n      } else {\n        end = e;\n        k = e + 1;\n      }\n    }\n\n    return extension.slice(start, end);\n  }\n\n  searchValue = \"-\" + key;\n  pos = extension.indexOf(searchValue);\n\n  if (pos !== -1 && pos + 3 === size) {\n    return '';\n  }\n\n  return undefined;\n}\n\nvar UNICODE_EXTENSION_SEQUENCE_REGEX = /-u(?:-[0-9a-z]{2,8})+/gi;\n/**\n * https://tc39.es/ecma402/#sec-bestavailablelocale\n * @param availableLocales\n * @param locale\n */\n\nfunction bestAvailableLocale(availableLocales, locale) {\n  var candidate = locale;\n\n  while (true) {\n    if (~availableLocales.indexOf(candidate)) {\n      return candidate;\n    }\n\n    var pos = candidate.lastIndexOf('-');\n\n    if (!~pos) {\n      return undefined;\n    }\n\n    if (pos >= 2 && candidate[pos - 2] === '-') {\n      pos -= 2;\n    }\n\n    candidate = candidate.slice(0, pos);\n  }\n}\n\nfunction createLookupMatcher(getDefaultLocale) {\n  /**\n   * https://tc39.es/ecma402/#sec-lookupmatcher\n   */\n  return function lookupMatcher(availableLocales, requestedLocales) {\n    var result = {\n      locale: ''\n    };\n\n    for (var _i = 0, requestedLocales_1 = requestedLocales; _i < requestedLocales_1.length; _i++) {\n      var locale = requestedLocales_1[_i];\n      var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n      var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n\n      if (availableLocale) {\n        result.locale = availableLocale;\n\n        if (locale !== noExtensionLocale) {\n          result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n        }\n\n        return result;\n      }\n    }\n\n    result.locale = getDefaultLocale();\n    return result;\n  };\n}\n\nfunction createBestFitMatcher(getDefaultLocale) {\n  return function bestFitMatcher(availableLocales, requestedLocales) {\n    var result = {\n      locale: ''\n    };\n\n    for (var _i = 0, requestedLocales_2 = requestedLocales; _i < requestedLocales_2.length; _i++) {\n      var locale = requestedLocales_2[_i];\n      var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n      var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n\n      if (availableLocale) {\n        result.locale = availableLocale;\n\n        if (locale !== noExtensionLocale) {\n          result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n        }\n\n        return result;\n      }\n    }\n\n    result.locale = getDefaultLocale();\n    return result;\n  };\n}\n\nexport function getLocaleHierarchy(locale) {\n  var results = [locale];\n  var localeParts = locale.split('-');\n\n  for (var i = localeParts.length; i > 1; i--) {\n    results.push(localeParts.slice(0, i - 1).join('-'));\n  }\n\n  return results;\n}\n\nfunction lookupSupportedLocales(availableLocales, requestedLocales) {\n  var subset = [];\n\n  for (var _i = 0, requestedLocales_3 = requestedLocales; _i < requestedLocales_3.length; _i++) {\n    var locale = requestedLocales_3[_i];\n    var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n    var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n\n    if (availableLocale) {\n      subset.push(availableLocale);\n    }\n  }\n\n  return subset;\n}\n\nexport function supportedLocales(availableLocales, requestedLocales, options) {\n  var matcher = 'best fit';\n\n  if (options !== undefined) {\n    options = toObject(options);\n    matcher = getOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n  }\n\n  if (matcher === 'best fit') {\n    return lookupSupportedLocales(availableLocales, requestedLocales);\n  }\n\n  return lookupSupportedLocales(availableLocales, requestedLocales);\n}\n\nvar MissingLocaleDataError =\n/** @class */\nfunction (_super) {\n  __extends(MissingLocaleDataError, _super);\n\n  function MissingLocaleDataError() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = 'MISSING_LOCALE_DATA';\n    return _this;\n  }\n\n  return MissingLocaleDataError;\n}(Error);\n\nexport function isMissingLocaleDataError(e) {\n  return e.type === 'MISSING_LOCALE_DATA';\n}\nexport function unpackData(locale, localeData,\n/** By default shallow merge the dictionaries. */\nreducer) {\n  if (reducer === void 0) {\n    reducer = function reducer(all, d) {\n      return __assign(__assign({}, all), d);\n    };\n  }\n\n  var localeHierarchy = getLocaleHierarchy(locale);\n  var dataToMerge = localeHierarchy.map(function (l) {\n    return localeData.data[l];\n  }).filter(Boolean);\n\n  if (!dataToMerge.length) {\n    throw new MissingLocaleDataError(\"Missing locale data for \\\"\" + locale + \"\\\", lookup hierarchy: \" + localeHierarchy.join(', '));\n  }\n\n  dataToMerge.reverse();\n  return dataToMerge.reduce(reducer, {});\n}","map":{"version":3,"sources":["../src/resolve-locale.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { invariant } from './invariant';\nimport { toObject, getOption } from './polyfill-utils';\nexport function createResolveLocale(getDefaultLocale) {\n    var lookupMatcher = createLookupMatcher(getDefaultLocale);\n    var bestFitMatcher = createBestFitMatcher(getDefaultLocale);\n    /**\n     * https://tc39.es/ecma402/#sec-resolvelocale\n     */\n    return function resolveLocale(availableLocales, requestedLocales, options, relevantExtensionKeys, localeData) {\n        var matcher = options.localeMatcher;\n        var r;\n        if (matcher === 'lookup') {\n            r = lookupMatcher(availableLocales, requestedLocales);\n        }\n        else {\n            r = bestFitMatcher(availableLocales, requestedLocales);\n        }\n        var foundLocale = r.locale;\n        var result = { locale: '', dataLocale: foundLocale };\n        var supportedExtension = '-u';\n        for (var _i = 0, relevantExtensionKeys_1 = relevantExtensionKeys; _i < relevantExtensionKeys_1.length; _i++) {\n            var key = relevantExtensionKeys_1[_i];\n            var foundLocaleData = localeData[foundLocale];\n            invariant(typeof foundLocaleData === 'object' && foundLocaleData !== null, \"locale data \" + key + \" must be an object\");\n            var keyLocaleData = foundLocaleData[key];\n            invariant(Array.isArray(keyLocaleData), \"keyLocaleData for \" + key + \" must be an array\");\n            var value = keyLocaleData[0];\n            invariant(typeof value === 'string' || value === null, \"value must be string or null but got \" + typeof value + \" in key \" + key);\n            var supportedExtensionAddition = '';\n            if (r.extension) {\n                var requestedValue = unicodeExtensionValue(r.extension, key);\n                if (requestedValue !== undefined) {\n                    if (requestedValue !== '') {\n                        if (~keyLocaleData.indexOf(requestedValue)) {\n                            value = requestedValue;\n                            supportedExtensionAddition = \"-\" + key + \"-\" + value;\n                        }\n                    }\n                    else if (~requestedValue.indexOf('true')) {\n                        value = 'true';\n                        supportedExtensionAddition = \"-\" + key;\n                    }\n                }\n            }\n            if (key in options) {\n                var optionsValue = options[key];\n                invariant(typeof optionsValue === 'string' ||\n                    typeof optionsValue === 'undefined' ||\n                    optionsValue === null, 'optionsValue must be String, Undefined or Null');\n                if (~keyLocaleData.indexOf(optionsValue)) {\n                    if (optionsValue !== value) {\n                        value = optionsValue;\n                        supportedExtensionAddition = '';\n                    }\n                }\n            }\n            result[key] = value;\n            supportedExtension += supportedExtensionAddition;\n        }\n        if (supportedExtension.length > 2) {\n            var privateIndex = foundLocale.indexOf('-x-');\n            if (privateIndex === -1) {\n                foundLocale = foundLocale + supportedExtension;\n            }\n            else {\n                var preExtension = foundLocale.slice(0, privateIndex);\n                var postExtension = foundLocale.slice(privateIndex, foundLocale.length);\n                foundLocale = preExtension + supportedExtension + postExtension;\n            }\n            foundLocale = Intl.getCanonicalLocales(foundLocale)[0];\n        }\n        result.locale = foundLocale;\n        return result;\n    };\n}\n/**\n * https://tc39.es/ecma402/#sec-unicodeextensionvalue\n * @param extension\n * @param key\n */\nfunction unicodeExtensionValue(extension, key) {\n    invariant(key.length === 2, 'key must have 2 elements');\n    var size = extension.length;\n    var searchValue = \"-\" + key + \"-\";\n    var pos = extension.indexOf(searchValue);\n    if (pos !== -1) {\n        var start = pos + 4;\n        var end = start;\n        var k = start;\n        var done = false;\n        while (!done) {\n            var e = extension.indexOf('-', k);\n            var len = void 0;\n            if (e === -1) {\n                len = size - k;\n            }\n            else {\n                len = e - k;\n            }\n            if (len === 2) {\n                done = true;\n            }\n            else if (e === -1) {\n                end = size;\n                done = true;\n            }\n            else {\n                end = e;\n                k = e + 1;\n            }\n        }\n        return extension.slice(start, end);\n    }\n    searchValue = \"-\" + key;\n    pos = extension.indexOf(searchValue);\n    if (pos !== -1 && pos + 3 === size) {\n        return '';\n    }\n    return undefined;\n}\nvar UNICODE_EXTENSION_SEQUENCE_REGEX = /-u(?:-[0-9a-z]{2,8})+/gi;\n/**\n * https://tc39.es/ecma402/#sec-bestavailablelocale\n * @param availableLocales\n * @param locale\n */\nfunction bestAvailableLocale(availableLocales, locale) {\n    var candidate = locale;\n    while (true) {\n        if (~availableLocales.indexOf(candidate)) {\n            return candidate;\n        }\n        var pos = candidate.lastIndexOf('-');\n        if (!~pos) {\n            return undefined;\n        }\n        if (pos >= 2 && candidate[pos - 2] === '-') {\n            pos -= 2;\n        }\n        candidate = candidate.slice(0, pos);\n    }\n}\nfunction createLookupMatcher(getDefaultLocale) {\n    /**\n     * https://tc39.es/ecma402/#sec-lookupmatcher\n     */\n    return function lookupMatcher(availableLocales, requestedLocales) {\n        var result = { locale: '' };\n        for (var _i = 0, requestedLocales_1 = requestedLocales; _i < requestedLocales_1.length; _i++) {\n            var locale = requestedLocales_1[_i];\n            var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n            var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n            if (availableLocale) {\n                result.locale = availableLocale;\n                if (locale !== noExtensionLocale) {\n                    result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n                }\n                return result;\n            }\n        }\n        result.locale = getDefaultLocale();\n        return result;\n    };\n}\nfunction createBestFitMatcher(getDefaultLocale) {\n    return function bestFitMatcher(availableLocales, requestedLocales) {\n        var result = { locale: '' };\n        for (var _i = 0, requestedLocales_2 = requestedLocales; _i < requestedLocales_2.length; _i++) {\n            var locale = requestedLocales_2[_i];\n            var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n            var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n            if (availableLocale) {\n                result.locale = availableLocale;\n                if (locale !== noExtensionLocale) {\n                    result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n                }\n                return result;\n            }\n        }\n        result.locale = getDefaultLocale();\n        return result;\n    };\n}\nexport function getLocaleHierarchy(locale) {\n    var results = [locale];\n    var localeParts = locale.split('-');\n    for (var i = localeParts.length; i > 1; i--) {\n        results.push(localeParts.slice(0, i - 1).join('-'));\n    }\n    return results;\n}\nfunction lookupSupportedLocales(availableLocales, requestedLocales) {\n    var subset = [];\n    for (var _i = 0, requestedLocales_3 = requestedLocales; _i < requestedLocales_3.length; _i++) {\n        var locale = requestedLocales_3[_i];\n        var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n        var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n        if (availableLocale) {\n            subset.push(availableLocale);\n        }\n    }\n    return subset;\n}\nexport function supportedLocales(availableLocales, requestedLocales, options) {\n    var matcher = 'best fit';\n    if (options !== undefined) {\n        options = toObject(options);\n        matcher = getOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n    }\n    if (matcher === 'best fit') {\n        return lookupSupportedLocales(availableLocales, requestedLocales);\n    }\n    return lookupSupportedLocales(availableLocales, requestedLocales);\n}\nvar MissingLocaleDataError = /** @class */ (function (_super) {\n    __extends(MissingLocaleDataError, _super);\n    function MissingLocaleDataError() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = 'MISSING_LOCALE_DATA';\n        return _this;\n    }\n    return MissingLocaleDataError;\n}(Error));\nexport function isMissingLocaleDataError(e) {\n    return e.type === 'MISSING_LOCALE_DATA';\n}\nexport function unpackData(locale, localeData, \n/** By default shallow merge the dictionaries. */\nreducer) {\n    if (reducer === void 0) { reducer = function (all, d) { return (__assign(__assign({}, all), d)); }; }\n    var localeHierarchy = getLocaleHierarchy(locale);\n    var dataToMerge = localeHierarchy\n        .map(function (l) { return localeData.data[l]; })\n        .filter(Boolean);\n    if (!dataToMerge.length) {\n        throw new MissingLocaleDataError(\"Missing locale data for \\\"\" + locale + \"\\\", lookup hierarchy: \" + localeHierarchy.join(', '));\n    }\n    dataToMerge.reverse();\n    return dataToMerge.reduce(reducer, {});\n}\n//# sourceMappingURL=resolve-locale.js.map"]},"metadata":{},"sourceType":"module"}