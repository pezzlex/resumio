{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports[\"default\"] = void 0;\n\nvar _height = _interopRequireDefault(require(\"../run/height\"));\n\nvar _descent = _interopRequireDefault(require(\"../run/descent\"));\n\nvar _advanceWidth = _interopRequireDefault(require(\"../run/advanceWidth\"));\n\nvar _ascent = _interopRequireDefault(require(\"../attributedString/ascent\"));\n\nvar renderAttachments = function renderAttachments(ctx, run) {\n  ctx.save();\n  var font = run.attributes.font;\n  var space = font.glyphForCodePoint(0x20);\n  var objectReplacement = font.glyphForCodePoint(0xfffc);\n  var attachmentAdvance = 0;\n\n  for (var i = 0; i < run.glyphs.length; i++) {\n    var position = run.positions[i];\n    var glyph = run.glyphs[i];\n    attachmentAdvance += position.xAdvance || 0;\n\n    if (glyph.id === objectReplacement.id && run.attributes.attachment) {\n      ctx.translate(attachmentAdvance, position.yOffset || 0);\n      renderAttachment(ctx, run.attributes.attachment);\n      run.glyphs[i] = space;\n      attachmentAdvance = 0;\n    }\n  }\n\n  ctx.restore();\n};\n\nvar renderAttachment = function renderAttachment(ctx, attachment) {\n  var _attachment$xOffset = attachment.xOffset,\n      xOffset = _attachment$xOffset === void 0 ? 0 : _attachment$xOffset,\n      _attachment$yOffset = attachment.yOffset,\n      yOffset = _attachment$yOffset === void 0 ? 0 : _attachment$yOffset,\n      width = attachment.width,\n      height = attachment.height,\n      image = attachment.image;\n  ctx.translate(-width + xOffset, -height + yOffset);\n  ctx.image(image, 0, 0, {\n    fit: [width, height],\n    align: 'center',\n    valign: 'bottom'\n  });\n};\n\nvar renderRun = function renderRun(ctx, run, options) {\n  var _run$attributes = run.attributes,\n      font = _run$attributes.font,\n      fontSize = _run$attributes.fontSize,\n      color = _run$attributes.color,\n      link = _run$attributes.link,\n      opacity = _run$attributes.opacity;\n  var height = (0, _height[\"default\"])(run);\n  var descent = (0, _descent[\"default\"])(run);\n  var runAdvanceWidth = (0, _advanceWidth[\"default\"])(run);\n\n  if (options.outlineRuns) {\n    ctx.rect(0, -height, runAdvanceWidth, height).stroke();\n  }\n\n  ctx.fillColor(color);\n  ctx.fillOpacity(opacity);\n\n  if (link) {\n    ctx.link(0, -height - descent, runAdvanceWidth, height, link);\n  }\n\n  renderAttachments(ctx, run);\n\n  if (font.sbix || font.COLR && font.CPAL) {\n    ctx.save();\n    ctx.translate(0, -run.ascent);\n\n    for (var i = 0; i < run.glyphs.length; i++) {\n      var position = run.positions[i];\n      var glyph = run.glyphs[i];\n      ctx.save();\n      ctx.translate(position.xOffset, position.yOffset);\n      glyph.render(ctx, fontSize);\n      ctx.restore();\n      ctx.translate(position.xAdvance, position.yAdvance);\n    }\n\n    ctx.restore();\n  } else {\n    ctx.font(typeof font.name === 'string' ? font.name : font, fontSize);\n\n    try {\n      ctx._addGlyphs(run.glyphs, run.positions, 0, 0);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  ctx.translate(runAdvanceWidth, 0);\n};\n\nvar renderBackground = function renderBackground(ctx, rect, backgroundColor) {\n  ctx.rect(rect.x, rect.y, rect.width, rect.height);\n  ctx.fill(backgroundColor);\n};\n\nvar renderDecorationLine = function renderDecorationLine(ctx, line) {\n  ctx.save();\n  ctx.lineWidth(line.rect.height);\n  ctx.strokeOpacity(line.opacity);\n\n  if (/dashed/.test(line.style)) {\n    ctx.dash(3 * line.rect.height);\n  } else if (/dotted/.test(line.style)) {\n    ctx.dash(line.rect.height);\n  }\n\n  if (/wavy/.test(line.style)) {\n    var dist = Math.max(2, line.rect.height);\n    var step = 1.1 * dist;\n    var stepCount = Math.floor(line.rect.width / (2 * step)); // Adjust step to fill entire width\n\n    var remainingWidth = line.rect.width - stepCount * 2 * step;\n    var adjustment = remainingWidth / stepCount / 2;\n    step += adjustment;\n    var cp1y = line.rect.y + dist;\n    var cp2y = line.rect.y - dist;\n    var x = line.rect.x;\n    ctx.moveTo(line.rect.x, line.rect.y);\n\n    for (var i = 0; i < stepCount; i++) {\n      ctx.bezierCurveTo(x + step, cp1y, x + step, cp2y, x + 2 * step, line.rect.y);\n      x += 2 * step;\n    }\n  } else {\n    ctx.moveTo(line.rect.x, line.rect.y);\n    ctx.lineTo(line.rect.x + line.rect.width, line.rect.y);\n\n    if (/double/.test(line.style)) {\n      ctx.moveTo(line.rect.x, line.rect.y + line.rect.height * 2);\n      ctx.lineTo(line.rect.x + line.rect.width, line.rect.y + line.rect.height * 2);\n    }\n  }\n\n  ctx.stroke(line.color);\n  ctx.restore();\n};\n\nvar renderLine = function renderLine(ctx, line, options) {\n  var lineAscent = (0, _ascent[\"default\"])(line);\n\n  if (options.outlineLines) {\n    ctx.rect(line.box.x, line.box.y, line.box.width, line.box.height).stroke();\n  }\n\n  ctx.save();\n  ctx.translate(line.box.x, line.box.y + lineAscent);\n\n  for (var _iterator = line.runs, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n    var _ref;\n\n    if (_isArray) {\n      if (_i >= _iterator.length) break;\n      _ref = _iterator[_i++];\n    } else {\n      _i = _iterator.next();\n      if (_i.done) break;\n      _ref = _i.value;\n    }\n\n    var run = _ref;\n\n    if (run.attributes.backgroundColor) {\n      var backgroundRect = {\n        x: 0,\n        y: -lineAscent,\n        height: line.box.height,\n        width: (0, _advanceWidth[\"default\"])(run) - line.overflowRight\n      };\n      renderBackground(ctx, backgroundRect, run.attributes.backgroundColor);\n    }\n\n    renderRun(ctx, run, options);\n  }\n\n  ctx.restore();\n  ctx.save();\n  ctx.translate(line.box.x, line.box.y);\n\n  for (var _iterator2 = line.decorationLines, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n    var _ref2;\n\n    if (_isArray2) {\n      if (_i2 >= _iterator2.length) break;\n      _ref2 = _iterator2[_i2++];\n    } else {\n      _i2 = _iterator2.next();\n      if (_i2.done) break;\n      _ref2 = _i2.value;\n    }\n\n    var decorationLine = _ref2;\n    renderDecorationLine(ctx, decorationLine);\n  }\n\n  ctx.restore();\n};\n\nvar renderBlock = function renderBlock(ctx, block, options) {\n  for (var _iterator3 = block, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n    var _ref3;\n\n    if (_isArray3) {\n      if (_i3 >= _iterator3.length) break;\n      _ref3 = _iterator3[_i3++];\n    } else {\n      _i3 = _iterator3.next();\n      if (_i3.done) break;\n      _ref3 = _i3.value;\n    }\n\n    var line = _ref3;\n    renderLine(ctx, line, options);\n  }\n};\n\nvar render = function render(ctx, blocks, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  for (var _iterator4 = blocks, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n    var _ref4;\n\n    if (_isArray4) {\n      if (_i4 >= _iterator4.length) break;\n      _ref4 = _iterator4[_i4++];\n    } else {\n      _i4 = _iterator4.next();\n      if (_i4.done) break;\n      _ref4 = _i4.value;\n    }\n\n    var block = _ref4;\n    renderBlock(ctx, block, options);\n  }\n};\n\nvar _default = {\n  render: render\n};\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/pezannekhambatta/Desktop/resumio/node_modules/@react-pdf/textkit/renderers/pdf.js"],"names":["_interopRequireDefault","require","exports","__esModule","_height","_descent","_advanceWidth","_ascent","renderAttachments","ctx","run","save","font","attributes","space","glyphForCodePoint","objectReplacement","attachmentAdvance","i","glyphs","length","position","positions","glyph","xAdvance","id","attachment","translate","yOffset","renderAttachment","restore","_attachment$xOffset","xOffset","_attachment$yOffset","width","height","image","fit","align","valign","renderRun","options","_run$attributes","fontSize","color","link","opacity","descent","runAdvanceWidth","outlineRuns","rect","stroke","fillColor","fillOpacity","sbix","COLR","CPAL","ascent","render","yAdvance","name","_addGlyphs","error","console","log","renderBackground","backgroundColor","x","y","fill","renderDecorationLine","line","lineWidth","strokeOpacity","test","style","dash","dist","Math","max","step","stepCount","floor","remainingWidth","adjustment","cp1y","cp2y","moveTo","bezierCurveTo","lineTo","renderLine","lineAscent","outlineLines","box","_iterator","runs","_isArray","Array","isArray","_i","Symbol","iterator","_ref","next","done","value","backgroundRect","overflowRight","_iterator2","decorationLines","_isArray2","_i2","_ref2","decorationLine","renderBlock","block","_iterator3","_isArray3","_i3","_ref3","blocks","_iterator4","_isArray4","_i4","_ref4","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports[\"default\"] = void 0;\n\nvar _height = _interopRequireDefault(require(\"../run/height\"));\n\nvar _descent = _interopRequireDefault(require(\"../run/descent\"));\n\nvar _advanceWidth = _interopRequireDefault(require(\"../run/advanceWidth\"));\n\nvar _ascent = _interopRequireDefault(require(\"../attributedString/ascent\"));\n\nvar renderAttachments = function renderAttachments(ctx, run) {\n  ctx.save();\n  var font = run.attributes.font;\n  var space = font.glyphForCodePoint(0x20);\n  var objectReplacement = font.glyphForCodePoint(0xfffc);\n  var attachmentAdvance = 0;\n\n  for (var i = 0; i < run.glyphs.length; i++) {\n    var position = run.positions[i];\n    var glyph = run.glyphs[i];\n    attachmentAdvance += position.xAdvance || 0;\n\n    if (glyph.id === objectReplacement.id && run.attributes.attachment) {\n      ctx.translate(attachmentAdvance, position.yOffset || 0);\n      renderAttachment(ctx, run.attributes.attachment);\n      run.glyphs[i] = space;\n      attachmentAdvance = 0;\n    }\n  }\n\n  ctx.restore();\n};\n\nvar renderAttachment = function renderAttachment(ctx, attachment) {\n  var _attachment$xOffset = attachment.xOffset,\n      xOffset = _attachment$xOffset === void 0 ? 0 : _attachment$xOffset,\n      _attachment$yOffset = attachment.yOffset,\n      yOffset = _attachment$yOffset === void 0 ? 0 : _attachment$yOffset,\n      width = attachment.width,\n      height = attachment.height,\n      image = attachment.image;\n  ctx.translate(-width + xOffset, -height + yOffset);\n  ctx.image(image, 0, 0, {\n    fit: [width, height],\n    align: 'center',\n    valign: 'bottom'\n  });\n};\n\nvar renderRun = function renderRun(ctx, run, options) {\n  var _run$attributes = run.attributes,\n      font = _run$attributes.font,\n      fontSize = _run$attributes.fontSize,\n      color = _run$attributes.color,\n      link = _run$attributes.link,\n      opacity = _run$attributes.opacity;\n  var height = (0, _height[\"default\"])(run);\n  var descent = (0, _descent[\"default\"])(run);\n  var runAdvanceWidth = (0, _advanceWidth[\"default\"])(run);\n\n  if (options.outlineRuns) {\n    ctx.rect(0, -height, runAdvanceWidth, height).stroke();\n  }\n\n  ctx.fillColor(color);\n  ctx.fillOpacity(opacity);\n\n  if (link) {\n    ctx.link(0, -height - descent, runAdvanceWidth, height, link);\n  }\n\n  renderAttachments(ctx, run);\n\n  if (font.sbix || font.COLR && font.CPAL) {\n    ctx.save();\n    ctx.translate(0, -run.ascent);\n\n    for (var i = 0; i < run.glyphs.length; i++) {\n      var position = run.positions[i];\n      var glyph = run.glyphs[i];\n      ctx.save();\n      ctx.translate(position.xOffset, position.yOffset);\n      glyph.render(ctx, fontSize);\n      ctx.restore();\n      ctx.translate(position.xAdvance, position.yAdvance);\n    }\n\n    ctx.restore();\n  } else {\n    ctx.font(typeof font.name === 'string' ? font.name : font, fontSize);\n\n    try {\n      ctx._addGlyphs(run.glyphs, run.positions, 0, 0);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  ctx.translate(runAdvanceWidth, 0);\n};\n\nvar renderBackground = function renderBackground(ctx, rect, backgroundColor) {\n  ctx.rect(rect.x, rect.y, rect.width, rect.height);\n  ctx.fill(backgroundColor);\n};\n\nvar renderDecorationLine = function renderDecorationLine(ctx, line) {\n  ctx.save();\n  ctx.lineWidth(line.rect.height);\n  ctx.strokeOpacity(line.opacity);\n\n  if (/dashed/.test(line.style)) {\n    ctx.dash(3 * line.rect.height);\n  } else if (/dotted/.test(line.style)) {\n    ctx.dash(line.rect.height);\n  }\n\n  if (/wavy/.test(line.style)) {\n    var dist = Math.max(2, line.rect.height);\n    var step = 1.1 * dist;\n    var stepCount = Math.floor(line.rect.width / (2 * step)); // Adjust step to fill entire width\n\n    var remainingWidth = line.rect.width - stepCount * 2 * step;\n    var adjustment = remainingWidth / stepCount / 2;\n    step += adjustment;\n    var cp1y = line.rect.y + dist;\n    var cp2y = line.rect.y - dist;\n    var x = line.rect.x;\n    ctx.moveTo(line.rect.x, line.rect.y);\n\n    for (var i = 0; i < stepCount; i++) {\n      ctx.bezierCurveTo(x + step, cp1y, x + step, cp2y, x + 2 * step, line.rect.y);\n      x += 2 * step;\n    }\n  } else {\n    ctx.moveTo(line.rect.x, line.rect.y);\n    ctx.lineTo(line.rect.x + line.rect.width, line.rect.y);\n\n    if (/double/.test(line.style)) {\n      ctx.moveTo(line.rect.x, line.rect.y + line.rect.height * 2);\n      ctx.lineTo(line.rect.x + line.rect.width, line.rect.y + line.rect.height * 2);\n    }\n  }\n\n  ctx.stroke(line.color);\n  ctx.restore();\n};\n\nvar renderLine = function renderLine(ctx, line, options) {\n  var lineAscent = (0, _ascent[\"default\"])(line);\n\n  if (options.outlineLines) {\n    ctx.rect(line.box.x, line.box.y, line.box.width, line.box.height).stroke();\n  }\n\n  ctx.save();\n  ctx.translate(line.box.x, line.box.y + lineAscent);\n\n  for (var _iterator = line.runs, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n    var _ref;\n\n    if (_isArray) {\n      if (_i >= _iterator.length) break;\n      _ref = _iterator[_i++];\n    } else {\n      _i = _iterator.next();\n      if (_i.done) break;\n      _ref = _i.value;\n    }\n\n    var run = _ref;\n\n    if (run.attributes.backgroundColor) {\n      var backgroundRect = {\n        x: 0,\n        y: -lineAscent,\n        height: line.box.height,\n        width: (0, _advanceWidth[\"default\"])(run) - line.overflowRight\n      };\n      renderBackground(ctx, backgroundRect, run.attributes.backgroundColor);\n    }\n\n    renderRun(ctx, run, options);\n  }\n\n  ctx.restore();\n  ctx.save();\n  ctx.translate(line.box.x, line.box.y);\n\n  for (var _iterator2 = line.decorationLines, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n    var _ref2;\n\n    if (_isArray2) {\n      if (_i2 >= _iterator2.length) break;\n      _ref2 = _iterator2[_i2++];\n    } else {\n      _i2 = _iterator2.next();\n      if (_i2.done) break;\n      _ref2 = _i2.value;\n    }\n\n    var decorationLine = _ref2;\n    renderDecorationLine(ctx, decorationLine);\n  }\n\n  ctx.restore();\n};\n\nvar renderBlock = function renderBlock(ctx, block, options) {\n  for (var _iterator3 = block, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n    var _ref3;\n\n    if (_isArray3) {\n      if (_i3 >= _iterator3.length) break;\n      _ref3 = _iterator3[_i3++];\n    } else {\n      _i3 = _iterator3.next();\n      if (_i3.done) break;\n      _ref3 = _i3.value;\n    }\n\n    var line = _ref3;\n    renderLine(ctx, line, options);\n  }\n};\n\nvar render = function render(ctx, blocks, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  for (var _iterator4 = blocks, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n    var _ref4;\n\n    if (_isArray4) {\n      if (_i4 >= _iterator4.length) break;\n      _ref4 = _iterator4[_i4++];\n    } else {\n      _i4 = _iterator4.next();\n      if (_i4.done) break;\n      _ref4 = _i4.value;\n    }\n\n    var block = _ref4;\n    renderBlock(ctx, block, options);\n  }\n};\n\nvar _default = {\n  render: render\n};\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}