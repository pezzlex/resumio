{"ast":null,"code":"import _classCallCheck from \"/Users/pezannekhambatta/Desktop/resumio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _inherits from \"/Users/pezannekhambatta/Desktop/resumio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/pezannekhambatta/Desktop/resumio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { EventEmitter } from 'events';\nimport Auth0Lock from 'auth0-lock';\nimport history from '@iso/lib/helpers/history';\nimport Auth0Config from '@iso/config/auth0.config';\nimport notification from '@iso/components/Feedback/Notification';\n\nvar Auth0 = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Auth0, _EventEmitter);\n\n  var _super = _createSuper(Auth0);\n\n  function Auth0() {\n    var _this;\n\n    _classCallCheck(this, Auth0);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.lock = new Auth0Lock(Auth0Config.clientID, Auth0Config.domain, Auth0Config.options);\n\n    _this.login = function () {\n      if (!_this.lock) {\n        return;\n      }\n\n      _this.lock.show();\n    };\n\n    _this.handleAuthentication = function () {\n      // Add callback Lock's `authenticated` event\n      _this.lock.on('authenticated', _this.setSession); // Add callback for Lock's `authorization_error` event\n\n\n      _this.lock.on('authorization_error', function (error) {\n        return notification('error', 'Wrong mail or password');\n      });\n    };\n\n    _this.setSession = function (authResult) {\n      // Set the time that the access token will expire at\n      var expiresAt = JSON.stringify(authResult.expiresIn * 1000 + new Date().getTime());\n      localStorage.setItem('access_token', authResult.accessToken);\n      localStorage.setItem('id_token', authResult.idToken);\n      localStorage.setItem('expires_at', expiresAt); // navigate to the dashboard route\n\n      history.replace('/dashboard');\n    };\n\n    _this.logout = function () {\n      // Clear access token and ID token from local storage\n      localStorage.removeItem('access_token');\n      localStorage.removeItem('id_token');\n      localStorage.removeItem('expires_at'); // navigate to the home route\n\n      history.replace('/');\n    };\n\n    _this.isAuthenticated = function () {\n      var expiresAt = JSON.parse(localStorage.getItem('expiresAt'));\n      return new Date().getTime() < expiresAt;\n    };\n\n    return _this;\n  }\n\n  return Auth0;\n}(EventEmitter);\n\nexport default new Auth0();","map":{"version":3,"sources":["/Users/pezannekhambatta/Desktop/resumio/packages/isomorphic-boilerplate-single/src/containers/Authentication/Auth0/Auth0.js"],"names":["EventEmitter","Auth0Lock","history","Auth0Config","notification","Auth0","lock","clientID","domain","options","login","show","handleAuthentication","on","setSession","error","authResult","expiresAt","JSON","stringify","expiresIn","Date","getTime","localStorage","setItem","accessToken","idToken","replace","logout","removeItem","isAuthenticated","parse","getItem"],"mappings":";;;AAAA,SAASA,YAAT,QAA6B,QAA7B;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,YAAP,MAAyB,uCAAzB;;IAEMC,K;;;;;;;;;;;;;;;UACJC,I,GAAO,IAAIL,SAAJ,CACLE,WAAW,CAACI,QADP,EAELJ,WAAW,CAACK,MAFP,EAGLL,WAAW,CAACM,OAHP,C;;UAMPC,K,GAAQ,YAAM;AACZ,UAAI,CAAC,MAAKJ,IAAV,EAAgB;AACd;AACD;;AACD,YAAKA,IAAL,CAAUK,IAAV;AACD,K;;UACDC,oB,GAAuB,YAAM;AAC3B;AACA,YAAKN,IAAL,CAAUO,EAAV,CAAa,eAAb,EAA8B,MAAKC,UAAnC,EAF2B,CAG3B;;;AACA,YAAKR,IAAL,CAAUO,EAAV,CAAa,qBAAb,EAAoC,UAAAE,KAAK;AAAA,eACvCX,YAAY,CAAC,OAAD,EAAU,wBAAV,CAD2B;AAAA,OAAzC;AAGD,K;;UACDU,U,GAAa,UAAAE,UAAU,EAAI;AACzB;AACA,UAAIC,SAAS,GAAGC,IAAI,CAACC,SAAL,CACdH,UAAU,CAACI,SAAX,GAAuB,IAAvB,GAA8B,IAAIC,IAAJ,GAAWC,OAAX,EADhB,CAAhB;AAGAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCR,UAAU,CAACS,WAAhD;AACAF,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCR,UAAU,CAACU,OAA5C;AACAH,MAAAA,YAAY,CAACC,OAAb,CAAqB,YAArB,EAAmCP,SAAnC,EAPyB,CAQzB;;AACAf,MAAAA,OAAO,CAACyB,OAAR,CAAgB,YAAhB;AACD,K;;UACDC,M,GAAS,YAAM;AACb;AACAL,MAAAA,YAAY,CAACM,UAAb,CAAwB,cAAxB;AACAN,MAAAA,YAAY,CAACM,UAAb,CAAwB,UAAxB;AACAN,MAAAA,YAAY,CAACM,UAAb,CAAwB,YAAxB,EAJa,CAKb;;AACA3B,MAAAA,OAAO,CAACyB,OAAR,CAAgB,GAAhB;AACD,K;;UAEDG,e,GAAkB,YAAM;AACtB,UAAIb,SAAS,GAAGC,IAAI,CAACa,KAAL,CAAWR,YAAY,CAACS,OAAb,CAAqB,WAArB,CAAX,CAAhB;AACA,aAAO,IAAIX,IAAJ,GAAWC,OAAX,KAAuBL,SAA9B;AACD,K;;;;;;EA5CiBjB,Y;;AA8CpB,eAAe,IAAIK,KAAJ,EAAf","sourcesContent":["import { EventEmitter } from 'events';\nimport Auth0Lock from 'auth0-lock';\nimport history from '@iso/lib/helpers/history';\nimport Auth0Config from '@iso/config/auth0.config';\nimport notification from '@iso/components/Feedback/Notification';\n\nclass Auth0 extends EventEmitter {\n  lock = new Auth0Lock(\n    Auth0Config.clientID,\n    Auth0Config.domain,\n    Auth0Config.options\n  );\n\n  login = () => {\n    if (!this.lock) {\n      return;\n    }\n    this.lock.show();\n  };\n  handleAuthentication = () => {\n    // Add callback Lock's `authenticated` event\n    this.lock.on('authenticated', this.setSession);\n    // Add callback for Lock's `authorization_error` event\n    this.lock.on('authorization_error', error =>\n      notification('error', 'Wrong mail or password')\n    );\n  };\n  setSession = authResult => {\n    // Set the time that the access token will expire at\n    let expiresAt = JSON.stringify(\n      authResult.expiresIn * 1000 + new Date().getTime()\n    );\n    localStorage.setItem('access_token', authResult.accessToken);\n    localStorage.setItem('id_token', authResult.idToken);\n    localStorage.setItem('expires_at', expiresAt);\n    // navigate to the dashboard route\n    history.replace('/dashboard');\n  };\n  logout = () => {\n    // Clear access token and ID token from local storage\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('id_token');\n    localStorage.removeItem('expires_at');\n    // navigate to the home route\n    history.replace('/');\n  };\n\n  isAuthenticated = () => {\n    let expiresAt = JSON.parse(localStorage.getItem('expiresAt'));\n    return new Date().getTime() < expiresAt;\n  };\n}\nexport default new Auth0();\n"]},"metadata":{},"sourceType":"module"}